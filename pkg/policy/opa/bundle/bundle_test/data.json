{
  "policies": [
    {
      "id": "TestBasicCanary",
      "meta": {
        "version": "0.1",
        "date": "2021-08-01 21:32:44 UTC",
        "description": "Access enabling user self service for users with role",
        "applicationId": "CanaryBank1",
        "layer": "Browser"
      },
      "subject": {
        "type": "basic",
        "providerId": "myGoogleIDP",
        "role": "canarySelfService"
      },
      "actions": [
        {
          "name": "createProfileBasic",
          "actionUri": "ietf:http:POST:/testpath*"
        },
        { "name": "editProfileBasic",
          "actionUri": "ietf:http:PUT:/testpath*"
        },
        { "name": "getProfileBasic",
          "actionUri": "ietf:http:GET:/testpath*"
        }
      ],
      "object": {
        "assetId": "CanaryProfileService",
        "pathSpec": "/testpath*"
      }
    },
    {
      "id": "TestJwtCanary",
      "meta": {
        "version": "0.1",
        "date": "2021-08-01 21:32:44 UTC",
        "description": "Access enabling user self service for users with role",
        "applicationId": "CanaryBank1",
        "layer": "Browser"
      },
      "subject": {
        "type": "jwt",
        "providerId": "myTestIDP",
        "config": {
          "iss": "testIssuer",
          "aud": "testAudience"
        },
        "role": "canarySelfService"
      },
      "actions": [
        {
          "name": "createProfileJWT",
          "actionUri": "ietf:http:POST:/testpath*"
        },
        { "name": "editProfileJWT",
          "actionUri": "ietf:http:PUT:/testpath*",
          "exclude" : true
        },
        { "name": "getProfileJWT",
          "actionUri": "ietf:http:GET:/testpath*"
        }
      ],
      "object": {
        "assetId": "CanaryProfileService",
        "pathSpec": "/testpath*"
      }
    },
    {
      "id": "TestIPMaskCanary",
      "meta": {
        "version": "0.1",
        "date": "2021-08-01 21:32:44 UTC",
        "description": "Access enabling user self service for users with role",
        "applicationId": "CanaryBank1",
        "layer": "Browser"
      },
      "subject": {
        "type": "net",
        "providerId": "myTestIDP",
        "cidr" : "127.0.0.1/24",
        "role": "canarySelfService"
      },
      "actions": [
        {
          "name": "createProfileIP",
          "actionUri": "ietf:http:POST:/testpath*"
        },
        { "name": "editProfileIP",
          "actionUri": "ietf:http:PUT:/testpath*",
          "exclude": true
        },
        { "name": "getProfileIP",
          "actionUri": "ietf:http:GET:/testpath*"
        }
      ],
      "object": {
        "assetId": "CanaryProfileService",
        "pathSpec": "/testpath*"
      }
    },
    {
      "id": "EditProfileGoogleUpdate AdminContractor",
      "meta": {
        "version": "0.1",
        "date": "2021-08-01 21:32:44 UTC",
        "description": "Access policy enabling contract staff to edit profiles",
        "applicationId": "CanaryBank1",
        "layer": "Browser"
      },
      "subject": {
        "type": "op",
        "providerId": "myGoogleIDP"
      },
      "actions": [
        {
          "name": "editProfile",
          "actionUri": "accountEdit"
        }
      ],
      "object": {
        "assetId": "CanaryProfileService",
        "pathSpec": "/Profile/*"
      },
      "condition": {
        "rule": "User:employeeType eq contract",
        "action": "allow"
      }
    },
    {
      "id": "CanaryProfileInternalNetUpdate",
      "meta": {
        "version": "0.1",
        "date": "2021-08-01 21:32:44 UTC",
        "description": "Enabling profile update for internal network services",
        "applicationId": "CanaryBank1",
        "layer": "Services"
      },
      "subject": {
        "type": "net",
        "cidr": "192.168.1.0/24",
        "members": ["WorkFlowSvcAcnt"]
      },
      "actions": [
        {
          "name": "createProfile",
          "actionUri": "accountCreate"
        },
        { "name": "editProfile",
          "actionUri": "accountEdit"
        }
      ],
      "object": {
        "assetId": "CanaryProfileService",
        "pathSpec": "/Profile/*"
      }
    }
  ]
}